## å¼‚æ­¥è¿›é˜¶ä¸»è¦è®²è¿°çš„çŸ¥è¯†ç‚¹
 - event loop
 - promise è¿›é˜¶
 - async/await
 - å¾®ä»»åŠ¡/å®ä»»åŠ¡

è¿˜æ˜¯å…ˆçœ‹å‡ ä¸ªé¢è¯•é¢˜ï¼Œçœ‹è‡ªå·±æ˜¯å¦èƒ½å¤Ÿå£é½¿æ¸…æ™°çš„å›ç­”å‡ºæ¥
### é—®ç­”é¢˜
 - è¯·æè¿°event loop(äº‹ä»¶å¾ªç¯/äº‹ä»¶è½®è¯¢)çš„æœºåˆ¶ï¼Œå¯ç”»å›¾
 - ä»€ä¹ˆæ˜¯å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡ï¼Œä¸¤è€…æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
 - Promiseæœ‰å“ªä¸‰ç§çŠ¶æ€ï¼Ÿå¦‚ä½•å˜åŒ–ï¼Ÿ
### åœºæ™¯é¢˜ - promise then å’Œ catchçš„è¿æ¥
```
// ç¬¬ä¸€é¢˜
Promise.resolve().then(() => {
  console.log(1)
}).catch(() => {
  console.log(2)
}).then(() => {
  console.log(3)
})

// ç¬¬äºŒé¢˜
Promise.resolve().then(() => {
  console.log(1)
  throw new Error('error1')
}).catch(() => {
  console.log(2)
}).then(() => {
  console.log(3)
})

// ç¬¬ä¸‰é¢˜
Promise.resolve().then(() => {
  console.log(1)
  throw new Error('error1')
}).catch(() => {
  console.log(2)
}).catch(() => {  // è¿™é‡Œæ˜¯catch
  console.log(3)
})
```
### åœºæ™¯é¢˜ - async/await è¯­æ³•

```
async function fn() {
  return 100
}
(async function() {
  const a = fn()  // ??
  const b = await fn() // ??
})()

(async function () {
  console.log('start')
  const a = await 100
  console.log('a', a)
  const b = await Promise.resolve(200)
  console.log('b', b)
  const c = await Promise.reject(300)
  console.log('c', c)
  console.log('end')
})()  // æ‰§è¡Œå®Œæ¯•ï¼Œæ‰“å°å‡ºå“ªäº›å†…å®¹ï¼Ÿ
```

### åœºæ™¯é¢˜ - promiseå’ŒsetTimeoutçš„é¡ºåº
```
console.log(100)
setTimeout(() => {
  console.log(200)
})
Promise.resolve().then(() => {
  console.log(300)
})
console.log(400)
```

### åœºæ™¯é¢˜ - å¤–åŠ  async/await çš„é¡ºåºé—®é¢˜
```
async function async1 () {
  console.log('async1 start')
  await async2()
  console.log('async1 end')
}
async function async2 () {
  console.log('async2')
}
console.log('script start')

setTimeout(function () {
  console.log('setTimeout')
}, 0)

async1()

new Promise (function (resolve) {
  console.log(promise1)
  resolve()
}).then(function() {
  console.log('promise2')
})

console.log('script end')
```

<hr />
### event loop (äº‹ä»¶å¾ªç¯/äº‹ä»¶è½®è¯¢)
  - JSæ˜¯å•çº¿ç¨‹è¿è¡Œçš„
  - å¼‚æ­¥è¦åŸºäºå›è°ƒå‡½æ•°æ¥å®ç°
  - event loop å°±æ˜¯å¼‚æ­¥å›è°ƒçš„å®ç°åŸç†

### JSæ˜¯å¦‚ä½•æ‰§è¡Œä»£ç çš„ï¼Ÿ
```
ä»å‰åˆ°åï¼Œä¸€è¡Œä¸€è¡Œçš„æ‰§è¡Œï¼Œå¦‚æœæŸä¸€è¡Œä»£ç æ‰§è¡Œé”™è¯¯ï¼Œåˆ™åœæ­¢ä¸‹é¢ä»£ç çš„æ‰§è¡Œï¼Œå¹¶ä¸”æ˜¯å…ˆæŠŠåŒæ­¥ä»£ç æ‰§è¡Œå®Œï¼Œå†æ‰§è¡Œå¼‚æ­¥ä»£ç 
```
ç¤ºä¾‹
```
console.log('Hi')

setTimeout(function cb1() {
 console.log('cb1') // cb å³callback
}, 5000)

console.log('Bye')

```

æ¥ä¸‹æ¥ç”¨å›¾ç‰‡æ¥å±•ç¤ºè¯¥ä»£ç çš„Event Loopæ˜¯å¦‚ä½•è¿è¡Œçš„ğŸ’»
(å›¾ç‰‡ä¸€)

<img src='https://github.com/Bruce-shuai/Books/blob/main/JSåŸºç¡€/å¼‚æ­¥/photos/Event%20Loop%20-1.png' height='200px'>

åœ¨è¿™å¼ å›¾ç‰‡é‡Œæˆ‘ä»¬å¯å¾—åˆ° 
 - `Browser console`å³æ‰“å°åˆ°æµè§ˆå™¨çš„å†…å®¹
 - `Call Stack` å³è°ƒç”¨æ ˆ
 - `Web APIs` å³åœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹çš„æ¥å£ ä¾‹å¦‚æ­¤ç¤ºä¾‹ä»£ç çš„setTimeout
 - Callback Queue å›è°ƒé˜Ÿåˆ—

(å›¾ç‰‡äºŒ) -> å¼€å§‹æ‰§è¡Œç¤ºä¾‹çš„ç¬¬ä¸€è¡Œä»£ç 
<img src='https://github.com/Bruce-shuai/Books/blob/main/JSåŸºç¡€/å¼‚æ­¥/photos/Event%20Loop%20-%202.png' height='200px'>

